# vi: ft=zsh

# Sourcing exports doesn't work so yolo
# source ../../../omzsh/exports.sh
export PATH="$PATH:$HOME/bin/"

source "$HOME/.dotfiles/venv/bin/activate"

# Use detected monitor layout
hash autorandr &> /dev/null && autorandr -c

# Restore desktop background
~/.fehbg

# Notification deamon
bark dunst -- dunst -print &

# Keybindings
bark xbindkeys &
setxkbmap -config $HOME/.config/setxkbmap.conf &

# Compositing
bark picom &
bark redshift &

# Panels
bark tint2 &

#
# Panel applets
#

# Start nextcloud client
bark nextcloud &

# Network applet
bark nm-applet &

# Printer applet
bark system-config-printer-applet &

# KDEConnect panel indicator
kdeconnect-indicator &

# Mail client
GTK_THEME="Arc" GTK_ICON_THEME="Arc" bark evolution

# Bluetooth daemon
bark blueman-applet &

#
# Daemons
#

bark thunar -- thunar --daemon &

# OctoPrint automated uploader
bark octoload -- /home/marcel/bin/octoload watch &

bark maximize_large_windows -- /home/marcel/bin/maximize_large_windows.sh &

bark light-locker &

# Autolock screen
bark xidlehook \
	--not-when-audio \
	--not-when-fullscreen \
	--timer 60 \
		'xbacklight -get | tee /tmp/xbacklight_previous_value; xbacklight -set 1' \
		'xbacklight -set $(</tmp/xbacklight_previous_value)' \
	--timer 10 \
		'xbacklight -set $(</tmp/xbacklight_previous_value); light-locker-command -l' \
		'' \
	--timer 1800 \
		'sudo systemctl suspend' \
		'' &
