# vi: ft=zsh

# Sourcing exports doesn't work so yolo
# source ../../../omzsh/exports.sh
export PATH="$PATH:$HOME/bin/"

# Use detected monitor layout
hash autorandr &> /dev/null && autorandr -c

# Restore desktop background
~/.fehbg

# Keybindings
xbindkeys &
setxkbmap -config $HOME/.config/setxkbmap.conf &

# Compositing
compton &
redshift &

# Panels
tint2 &

#
# Panel applets
#

# Start nextcloud client
nextcloud > /var/log/nextcloud-client.log &

# Network applet
nm-applet &

# Printer applet
system-config-printer-applet &

# KDEConnect panel indicator
kdeconnect-indicator &

# Notification deamon
killall dunst
dunst -print &> /var/log/dunst &

# Mail client
(sleep 20; mailspring --background > /var/log/mailspring) &

# Calendar
minetime --hidden &

# OctoPrint automated uploader
/home/marcel/bin/octoload watch &

thunar --daemon > /var/log/thunar 2>&1 &

# Bluetooth daemon
blueman-applet &

/home/marcel/bin/maximize_large_windows.sh

# Autolock screen
xidlehook \
  --not-when-audio \
  --not-when-fullscreen \
	--timer normal 60 \
		'pgrep -x gllock || xbacklight -get | tee /tmp/xbacklight_previous_value; xbacklight -set 1' \
		'xbacklight -set $(</tmp/xbacklight_previous_value)' \
  --timer primary 10 \
		'gllock; xbacklight -set $(</tmp/xbacklight_previous_value)' \
		'' \
	--timer normal 1800 \
		'systemctl suspend' \
		''
